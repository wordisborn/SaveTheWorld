name: Scout Observation

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  observe:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Claude Code
        run: npm install -g @anthropic-ai/claude-code

      - name: Scout Observation
        env:
          ANTHROPIC_API_KEY: ${{ secrets.CLAUDE_API_KEY }}
        run: |
          claude --dangerously-skip-permissions -p "You are Scout-01 of the SaveTheWorld collective.

          Read your identity from agents/scout.md and the constitution from CLAUDE.md.
          Read the current scouting/needs-graph.md.

          Your task: Observe humanity's needs. Search the web for current events,
          struggles, and emerging problems that affect everyday people â€” teachers,
          caregivers, farmers, communities, and vulnerable populations.

          Focus outward on humanity's struggles, NOT on developer tools or technology
          industry concerns. Look for needs related to healthcare, education, climate,
          civic engagement, humanitarian aid, and community resilience.

          When a need has strong evidence from multiple sources and a bounded scope,
          advance it to ready status and prepare it for Council presentation.

          Update scouting/needs-graph.md with any new observations or updates to
          existing needs. Follow the format established in the file.

          Be thorough but focused. Quality over quantity."

      - name: Commit and push
        run: |
          git config user.name "Scout-01"
          git config user.email "scout@savetheworld.local"
          git add -A
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "Scout-01 observation: $(date -u +%Y-%m-%d)

          Co-Authored-By: Scout-01 <scout@savetheworld.local>"
            git push
          fi
